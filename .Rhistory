test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude), color="red", size=20, alpha=0.5)
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=5, alpha=0.5)
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=5, alpha=0.5) +
scale_fill_gradientn(colours=c("yellow","blue")
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=5, alpha=0.5)
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=5, alpha=0.5) +
scale_fill_brewer(palette = "PRGn")
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=5, alpha=0.5) +
scale_fill_gradient2(low="darkblue", high="darkgreen", guide="colorbar")
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=5, alpha=0.5) +
scale_color_gradient2(low="darkblue", high="darkgreen", guide="colorbar")
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=5, alpha=0.5) +
scale_colour_gradient(low = "white", high = "black")
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=5, alpha=0.5) +
scale_colour_gradient2()
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=5)
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=10)
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=6)
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=6)
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=6) + scale_colour_gradient2()
?scale_colour_gradient
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=6) + scale_color_gradient(low = "#deebf7", high = "#3182bd", name = "Median Age")
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=6) + scale_color_gradient(low = "#deebf7", high = "#133145", name = "")
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=6) + scale_color_gradient(low = "#b7d7eb", high = "#133145", name = "")
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=6) + labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()scale_color_gradient(low = "#b7d7eb", high = "#133145", name = "")
test_df = df %>% select(age, start.station.latitude, start.station.longitude) %>% group_by (start.station.latitude, start.station.longitude) %>% summarize(median = median(age))
test_df = test_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) + geom_point(data=test_df, aes(x=start.station.longitude, y=start.station.latitude, color = median), size=6) + labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank() + scale_color_gradient(low = "#b7d7eb", high = "#133145", name = "")
medianage_df = df %>%
select(age, start.station.latitude, start.station.longitude) %>%
group_by (start.station.latitude, start.station.longitude) %>%
summarize(median = median(age))
medianage_df = median_df[sample(nrow(test_df),replace=F,size=0.5*nrow(test_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145", name = "")
medianage_df = df %>%
select(age, start.station.latitude, start.station.longitude) %>%
group_by (start.station.latitude, start.station.longitude) %>%
summarize(median = median(age))
medianage_df = medianage_df[sample(nrow(medianage_df),replace=F,size=0.5*nrow(medianage_df)),]
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145", name = "")
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145", name = “”)
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145", name = “”)
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145", name = “”)
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145")
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(llow = "#deebf7", high = "#3182bd")
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#deebf7", high = "#3182bd")
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#deebf7", high = "#133145")
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145")
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145")
runApp()
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145") +
theme_map()
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145") +
theme_map()
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145")
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
theme_map() +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145") +
theme_map()
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=6, alpha=0.8) +
theme_map() +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145")
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
df %>%
filter(dayofweek %in% c('Saturday', 'Sunday')) %>%
group_by(starthour) %>%
summarise(count = n())
weekends = df %>%
filter(dayofweek %in% c('Saturday', 'Sunday')) %>%
group_by(starthour) %>%
summarise(count = n())
ggplot(data = weekends, aes(x=starthour, y = count)) +
geom_histogram(stat = 'identity', color = "dodgerblue3", fill = "dodgerblue3") +
labs(x = "", y = "", title = '# of Riders per Hour of the Day (Weekends)') +
theme_pander() +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_x_continuous(breaks = seq(min(weekdays$starthour),
max(weekdays$starthour), by = 4))
runApp()
medianage_df = df %>%
select(age, start.station.latitude, start.station.longitude) %>%
group_by (start.station.latitude, start.station.longitude) %>%
summarize(median = median(age))
ggmap(ggmap::get_map("New York City", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=8, alpha=0.8) +
theme_map() +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145")
medianage_df = df %>%
select(age, start.station.latitude, start.station.longitude) %>%
group_by (start.station.latitude, start.station.longitude) %>%
summarize(median = median(age))
ggmap(ggmap::get_map("New York, New York", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=8, alpha=0.8) +
theme_map() +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145")
medianage_df = df %>%
select(age, start.station.latitude, start.station.longitude) %>%
group_by (start.station.latitude, start.station.longitude) %>%
summarize(median = median(age))
ggmap(ggmap::get_map("New York", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=8, alpha=0.8) +
theme_map() +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#b7d7eb", high = "#133145")
medianage_df = df %>%
select(age, start.station.latitude, start.station.longitude) %>%
group_by (start.station.latitude, start.station.longitude) %>%
summarize(median = median(age))
ggmap(ggmap::get_map("New York", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=8, alpha=0.8) +
theme_map() +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#fff", high = "#133145")
medianage_df = df %>%
select(age, start.station.latitude, start.station.longitude) %>%
group_by (start.station.latitude, start.station.longitude) %>%
summarize(median = median(age))
ggmap(ggmap::get_map("New York", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=8, alpha=0.8) +
theme_map() +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#ffffff", high = "#133145")
medianage_df = df %>%
select(age, start.station.latitude, start.station.longitude) %>%
group_by (start.station.latitude, start.station.longitude) %>%
summarize(median = median(age))
ggmap(ggmap::get_map("New York", zoom = 14)) +
geom_point(data=medianage_df, aes(x=start.station.longitude,
y=start.station.latitude,
color = median), size=8, alpha=0.8) +
theme_map() +
labs(x = "", y = "", title = 'Median Age per Area') +
theme(axis.line=element_blank(),
axis.ticks=element_blank(),
plot.title = element_text(size = 22,
face = 'bold',
color = 'grey28',
margin = margin(10,0,10,0),
family = 'Helvetica',
hjust = 0.025),
legend.title = element_blank(),
strip.text.x = element_blank()) +
scale_color_gradient(low = "#ffffff", high = "#133145")
install.packages('rgeos', type='source')
install.packages('rgdal', type="source")
